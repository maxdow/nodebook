<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<title>4 Au service du d√©veloppement frontend</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="__span_class_chapitrenumero_4_span_au_service_du_d√©veloppement_frontend"><span class="ChapitreNumero">4</span> Au service du d√©veloppement frontend</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les chapitres pr√©c√©dents ont d√©montr√© l&#8217;utilit√© de Node pour la cr√©ation de modules r√©utilisables ainsi que pour le d√©veloppement d&#8217;applications et d&#8217;utilitaires.</p>
</div>
<div class="paragraph">
<p>Ce chapitre nous apprendra le r√¥le de Node pour le d√©veloppement <em>frontend</em> et la r√©alisation d&#8217;applications web.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ce chapitre est en pleine r√©orgnanisation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="content">
<div class="ulist">
<div class="title">Sommaire</div>
<ul>
<li>
<p>Choisir un gestionnaire de paquets</p>
</li>
<li>
<p>Un outillage sur mesure</p>
</li>
<li>
<p>Automatiser les projets</p>
</li>
<li>
<p>Partager du code entre Node et le navigateur</p>
</li>
<li>
<p>Tester dans le navigateur</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Avant l&#8217;apparition de Node, rare √©tait l&#8217;outillage n&#8217;imposant pas une plateforme enti√®re de d√©veloppement.
Il faut se contenter de programmes tels que <em>YUICompressor</em>, <em>Google Closure Compiler</em>, <em>sprockets</em> ou encore <em>pngquant</em>.
Leur utilisation requiert des d√©pendances vari√©es comme Ruby, Java ou des librairies, parfois incompatibles entre elles et dont la proc√©dure d&#8217;installation diff√®re selon les syst√®mes d&#8217;exploitation ‚Äî lorsqu&#8217;ils sont multi-plateformes.
C&#8217;est sans parler des difficult√©s d&#8217;int√©gration et de leur syst√©matisation au sein des projets.</p>
</div>
<div class="paragraph">
<p>Bref c&#8217;√©tait lourd, complexe et compliqu√© √† moins de disposer d&#8217;une infrastructure industrialis√©e.<br>
L&#8217;existence de Node a favoris√© le d√©veloppement d&#8217;un √©cosyst√®me entier d&#8217;outillage et ce, de la d√©couverte et le t√©l√©chargement des biblioth√®ques tierces √† la compilation, √† la phase d&#8217;optimisation et √† l&#8217;ex√©cution des tests de vos composants et applications web.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Remarque</span> Versions de Node et npm</div>
<div class="paragraph">
<p>Le contenu de ce chapitre se r√©f√®re aux versions de <strong>Node v6</strong> et <strong>npm v4</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#__span_class_chapitrenumero_4_span_au_service_du_d√©veloppement_frontend"><span class="ChapitreNumero">4</span> Au service du d√©veloppement frontend</a>
<ul class="sectlevel2">
<li><a href="#_node_pour_le_navigateur">Node pour le navigateur ?</a></li>
<li><a href="#_gestion_des_d√©pendances">Gestion des d√©pendances</a>
<ul class="sectlevel3">
<li><a href="#_npm">npm</a></li>
<li><a href="#_comprendre_em_npm_em_et_son_organisation_du_r√©pertoire_em_node_modules_em">Comprendre <em>npm</em> et son organisation du r√©pertoire <em>node_modules</em></a></li>
<li><a href="#_bower">bower</a></li>
</ul>
</li>
<li><a href="#_un_outillage_sur_mesure">Un outillage sur mesure</a></li>
<li><a href="#_√âchanges_de_donn√©es_client_serveur">√âchanges de donn√©es client/serveur</a></li>
<li><a href="#transpilation">Transpilation</a>
<ul class="sectlevel3">
<li><a href="#_traceur">Traceur</a></li>
<li><a href="#babel">Babel</a></li>
<li><a href="#typescript">TypeScript</a></li>
<li><a href="#_publication_sur_npm">Publication sur npm</a></li>
</ul>
</li>
<li><a href="#universal-applications">browserify, pierre angulaire d&#8217;un code universel</a>
<ul class="sectlevel3">
<li><a href="#_une_fonction_pour_node_et_un_navigateur_web">Une fonction pour Node et un navigateur web</a></li>
<li><a href="#browserify">Utilisation de <em>browserify</em></a></li>
<li><a href="#_une_fonction_universelle">Une fonction universelle</a></li>
<li><a href="#_cibler_sp√©cifiquement_node_ou_le_navigateur">Cibler sp√©cifiquement Node ou le navigateur</a></li>
</ul>
</li>
<li><a href="#_templating_universel_avec_react">Templating universel avec React</a>
<ul class="sectlevel3">
<li><a href="#_pr√©sentation_de_react">Pr√©sentation de React</a></li>
<li><a href="#_rendu_avec_node">Rendu avec Node</a></li>
<li><a href="#_rendu_dans_le_navigateur">Rendu dans le navigateur</a></li>
<li><a href="#_exemple_d_int√©gration_avec_em_express_em">Exemple d&#8217;int√©gration avec <em>express</em></a></li>
<li><a href="#_vers_des_applications_universelles">Vers des applications universelles ?</a></li>
</ul>
</li>
<li><a href="#_strat√©gies_de_gestion_des_ressources_frontend">Strat√©gies de gestion des ressources frontend</a></li>
<li><a href="#_tester_son_code">Tester son code</a>
<ul class="sectlevel3">
<li><a href="#_√âcrire_des_tests_avec_mocha_et_chai">√âcrire des tests avec mocha et chai</a></li>
<li><a href="#_ex√©cuter_les_suites_de_tests_avec_karma">Ex√©cuter les suites de tests avec Karma</a></li>
<li><a href="#_tester_la_compatibilit√©_navigateurs_avec_browserstack">Tester la compatibilit√© navigateurs avec BrowserStack</a></li>
<li><a href="#_le_cas_internet_explorer_et_ievms">Le cas Internet Explorer et ievms</a></li>
</ul>
</li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_node_pour_le_navigateur">Node pour le navigateur ?</h3>
<div class="paragraph">
<p>Ce chapitre peut sembler confus au premier abord :
si Node s&#8217;ex√©cute au niveau du syst√®me d&#8217;exploitation, en quoi  est-il li√© au d√©veloppement <em>frontend</em> ?</p>
</div>
<div class="paragraph">
<p>Commen√ßons par comprendre la r√©partition des responsabilit√©s :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>modules npm</strong> : <em>fonctions</em>, <em>librairies</em> et <em>outils</em> pr√™t √† l&#8217;emploi sur simple utilisation de la fonction <code>require()</code> ;</p>
</li>
<li>
<p><strong>npm</strong> : client permettant de t√©l√©charger et de publier des <em>modules npm</em> afin de les consommer dans notre code applicatif ;</p>
</li>
<li>
<p><strong>Node</strong> : environnement d&#8217;ex√©cution des diff√©rentes t√¢ches et outils pour rendre les applications web digestes par les navigateurs web.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Autrement dit, <strong>nous n&#8217;ex√©cutons pas Node dans un navigateur web</strong>.
Nous l&#8217;utilisons pour <strong>assembler du code</strong> et <strong>le transformer</strong> de sorte √† le rendre fonctionnel dans une paire de balises <code>&lt;script&gt;&lt;/script&gt;</code>.<br>
Ce code peut √™tre aussi bien fourni par des librairies tierces (type <em>jQuery</em>, <em>Angular</em>, <em>React</em> etc.) que par de l&#8217;outillage (optimiseurs, suite de tests, orchestration de t√¢ches etc.) ou encore par le code r√©utilisable de notre propre application web.</p>
</div>
</div>
<div class="sect2">
<h3 id="_gestion_des_d√©pendances">Gestion des d√©pendances</h3>
<div class="paragraph">
<p>Avant Node, l&#8217;obtention d&#8217;une biblioth√®que se faisait en allant sur son site web respectif puis en t√©l√©chargeant manuellement une archive avant de la d√©compresser dans votre r√©pertoire de travail.
C&#8217;est sans compter sur les t√©l√©chargements sur-mesure dont il fallait m√©moriser les options de mise √† jour en mise √† jour.</p>
</div>
<div class="paragraph">
<p>Tout ceci a bien √©volu√© gr√¢ce aux gestionnaires de paquets.
Ils rendent explicites la liste des d√©pendances, le spectre des versions compatibles ainsi que l&#8217;automatisation des op√©rations d&#8217;installation et de mises √† jour.</p>
</div>
<div class="sect3">
<h4 id="_npm">npm</h4>
<div class="paragraph">
<p><em>npm</em> est le gestionnaire de d√©pendances inclus dans les distributions courantes de Node.
Pourquoi en parler s&#8217;il ne fonctionne que pour Node ?
Car contrairement aux √† prioris, <strong>npm ne se limite pas √† la gestion des d√©pendances sp√©cifiques √† Node</strong>.
npm utilise Node comme moteur d&#8217;ex√©cution mais vous pouvez tout  fait empaqueter des images, fichiers CSS, Sass, <a href="#typescript">TypeScript</a> etc.</p>
</div>
<div class="paragraph">
<p>Quelles sont les raisons de choisir npm comme gestionnaire de d√©pendances <em>frontend</em> ?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>d√©claration explicite</strong> des points d&#8217;entr√©e via la propri√©t√© <em>main</em> du fichier <em>package.json</em> ;</p>
</li>
<li>
<p>gestion des d√©pendances de d√©pendances et quasi-absence de conflits de version ;</p>
</li>
<li>
<p>outillage et <strong>√©cosyst√®me riche</strong> et complet ;</p>
</li>
<li>
<p>transformation des appels <em>CommonJS</em> en modules <em>ECMAScript 2015</em> et vice-versa via des transpilateurs ou <em>transforms</em> ;</p>
</li>
<li>
<p>c&#8217;est le meilleur moyen d'<strong>atteindre l'<em>isomorphisme applicatif</em></strong> (lire <a href="#universal-applications">Vers un code universel et modulaire</a> dans ce m√™me chapitre).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>L&#8217;exemple suivant illustre plusieurs moyens d&#8217;inclure jQuery dans une page HTML, via une simple balise script, via un module <em>CommonJS</em> (syntaxe Node) ou via la syntaxe des <em>modules</em> d&#8217;ECMAScript 2015 :</p>
</div>
<div class="listingblock">
<div class="title">snippets/dependency-npm.html</div>
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!-- syntaxe classique (vanilla JS) --&gt;
&lt;script src="node_modules/jquery/dist/jquery.min.js"&gt;&lt;/script&gt;

&lt;!-- syntaxe CommonJS --&gt;
&lt;script&gt;
const $ = require('jquery');

$(document).ready(() =&gt; {
  // ...
});
&lt;/script&gt;

&lt;!-- syntaxe modules ECMAScript 2015 --&gt;
&lt;script&gt;
import $ from 'jquery';

$(document).ready(() =&gt; {
  // ...
});
&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;utilisation de modules <em>CommonJS</em> n√©cessite une √©tape de compilation avant de pouvoir fonctionner nativement dans le navigateur.
C&#8217;est quelque chose que nous adresserons dans la section <a href="../chapter-05/index.html#automation">automatisation des t√¢ches</a> du chapitre 5.</p>
</div>
<div class="paragraph">
<p>L&#8217;√©tape de compilation sera √©galement n√©cessaire si les navigateurs cibles de votre applications ne sont pas compatibles nativement avec les <em>modules ECMAScript 2015</em>.<br>
Pour cela nous aurons recours √† un <em>transpilateur</em>, pour convertir du code ECMAScript 2015 en ECMAScript 5.
Nous en reparlerons dans la section <a href="#transpilation">Transpilation</a> de ce m√™me chapitre.</p>
</div>
<div class="paragraph">
<p>Certains auteurs de paquets <em>npm</em> proposent du code pr√©alablement compil√© et pr√™t √† l&#8217;emploi, en g√©n√©ral et par convention dans un r√©pertoire <code>dist/</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_comprendre_em_npm_em_et_son_organisation_du_r√©pertoire_em_node_modules_em">Comprendre <em>npm</em> et son organisation du r√©pertoire <em>node_modules</em></h4>
<div class="paragraph">
<p><em>npm</em> organise les d√©pendances selon une structure dite <em>plate</em> (<em>flat tree structure</em>).
Ainsi, si deux modules distincts se basent sur une <strong>version compatible d&#8217;une m√™me d√©pendance</strong> selon <em>semver</em> ‚Äî ici, jQuery v2 ‚Äî  voici l&#8217;arbre de d√©pendance de <em>npm</em> et la disposition sur le syst√®me de fichiers qui en r√©sultent :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ npm ls
my-app@1.0.0
‚îú‚îÄ‚îÄ module-a@1.0.0
|   ‚îî‚îÄ‚îÄ jquery@2.1.0
‚îî‚îÄ‚îÄ module-b@1.0.0
    ‚îî‚îÄ‚îÄ jquery@2.1.4

$ tree node_modules
node_modules
‚îú‚îÄ‚îÄ jquery
‚îú‚îÄ‚îÄ module-a
‚îî‚îÄ‚îÄ module-b</pre>
</div>
</div>
<div class="paragraph">
<p>Dans le cas o√π plusieurs modules d√©pendant d&#8217;un m√™me paquet mais dans une version <em>semver</em> incompatible ‚Äî ici jQuery v1 et jQuery v2 ‚Äî la version la plus <em>ancienne</em> se trouvera √† la racine du r√©pertoire <em>node_modules</em> tandis que les autres seront <em>encapsul√©es</em> au plus pr√®s du module en d√©pendant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ npm ls
my-app@1.0.0
‚îú‚îÄ‚îÄ module-a@1.0.0
|   ‚îî‚îÄ‚îÄ jquery@1.11.3
‚îî‚îÄ‚îÄ module-b@1.0.0
    ‚îî‚îÄ‚îÄ jquery@2.1.4

$ tree node_modules
node_modules
‚îú‚îÄ‚îÄ jquery
‚îú‚îÄ‚îÄ module-a
‚îî‚îÄ‚îÄ module-b
    ‚îî‚îÄ‚îÄ jquery</pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;utilisation de <code>npm dedupe</code> peut √™tre un ultime recours pour optimiser un arbre plus complexe que celui-ci.
Ceci dans l&#8217;optique de diminuer les inclusions multiples d&#8217;une librairie techniquement compatible avec d&#8217;autres versions mineures.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Remarque</span> R√©solution de chemins</div>
<div class="paragraph">
<p>Il est fortement <strong>d√©conseill√© de se baser sur des chemins en dur</strong> tapant dans le r√©pertoire <em>node_modules</em>.
Il est <strong>pr√©f√©rable de faire appel √† <code>require.resolve</code></strong> pour d√©terminer le chemin vers un fichier compris dans une d√©pendance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// √Ä ne surtout pas faire
const jqueryCore = require('./node_modules/jquery/src/core.js');

// √Ä faire
const jQueryCore = require('jquery/src/core.js');</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Nous verrons davantage d&#8217;exemples, plus complets et tendant vers une m√™me base de code compatible √† la fois avec les API de Node et des navigateurs web dans la section <a href="#universal-applications">Vers un code universel et modulaire</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_bower">bower</h4>
<div class="paragraph">
<p><em>bower</em> est un gestionnaire de d√©pendances enti√®rement d√©di√© aux composants <em>frontend</em>.
Son interface est tr√®s proche de celle la commande npm.
Les d√©pendances sont quant √† elles list√©es dans un fichier <code>bower.json</code>, lui-m√™me tr√®s similaire au fichier <code>package.json</code>.</p>
</div>
<div class="paragraph">
<p>Ce projet a rencontr√© une forte popularit√© √† une √©poque o√π les d√©veloppeurs pensaient que <em>npm</em> √©tait d√©di√© uniquement √† Node et de ce fait, que <em>npm</em> n&#8217;√©tait pas adapt√© √† la gestion des d√©pendances <em>front-end</em>.</p>
</div>
<div class="paragraph">
<p>Toutefois je <strong>d√©conseille d&#8217;utiliser <em>bower</em></strong> pour les raisons suivantes :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>les fonctionnalit√©s sont identiques √† peu de chose pr√®s √† celles de <em>npm</em> ;</p>
</li>
<li>
<p>vous aurez la plupart besoin d&#8217;un peu d&#8217;outillage compl√©mentaire via <em>npm</em>, donc autant n&#8217;utiliser qu&#8217;un seul outil ;</p>
</li>
<li>
<p><em>bower</em> ne sait pas g√©rer la pr√©sence d&#8217;un m√™me module dans deux versions conflictuelles ‚Äî ce qui repr√©sente un frein aux installations automatis√©es ;</p>
</li>
<li>
<p>les composants <em>bower</em> ne peuvent √™tre employ√©es pour la cr√©ation d'<a href="#universal-applications">applications universelles</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>bower</em> dispose d&#8217;un seul avantage : la capacit√© √† collecter des  librairies qui ne sont pas d√©clar√©es dans un registre.
Cela peut se r√©v√©ler pratique pour l&#8217;inclusion de code tiers assez ancien.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_un_outillage_sur_mesure">Un outillage sur mesure</h3>
<div class="paragraph">
<p>Qu&#8217;il s&#8217;agisse de vos propres composants ou de modules tiers, l&#8217;√©cosyst√®me Node regorge d&#8217;utilitaires facilitant la vie de tout d√©veloppeur <em>frontend</em>.</p>
</div>
<div class="paragraph">
<p>Outre l&#8217;uniformisation de l&#8217;installation de vos composants et d√©pendances, <strong>vous rendez explicite et partagez le m√™me processus</strong> avec tous les membres de votre √©quipe.
Et m√™me si vous √™tes seul(e) sur le projet, vous construisez une documentation d&#8217;utilisation pour les prochaines personnes susceptibles de participer au projet.</p>
</div>
<div class="paragraph">
<p>L'<strong>ubiquit√© des utilitaires</strong> est un autre avantage ind√©niable.
Ils s&#8217;int√®grent en g√©n√©ral tr√®s bien avec des outils d&#8217;automatisation ou des <em>frameworks</em> populaires.
Par exemple <em>express</em> et <em>less</em>, <em>express</em> et <em>React</em> etc.</p>
</div>
<div class="paragraph">
<p>Vous trouverez ci-apr√®s une suggestion non-exhaustive de modules utiles √† tout d√©veloppeur <em>frontend</em> ou toute personne voulant r√©aliser des applications web modernes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_√âchanges_de_donn√©es_client_serveur">√âchanges de donn√©es client/serveur</h3>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect2">
<h3 id="transpilation">Transpilation</h3>
<div class="paragraph">
<p>Pendant longtemps, transformer de l&#8217;ECMAScript en ECMAScript ‚Äî par exemple de l&#8217;ES5 en ES3 ou un autre langage en ECMAScript n√©cessitait l&#8217;utilisation d&#8217;un autre environnement qu&#8217;ECMAScript lui-m√™me.<br>
Rhino n√©cessitait Java, Spidermonkey n√©cessitait C et Trident n√©cessitait un environnement Windows en plus de C.
M√™me Node et V8 requi√®rent C++ pour interpr√©ter de l&#8217;ECMAScript.</p>
</div>
<div class="paragraph">
<p>Pour autant, un projet va chambouler les r√®gles du jeu en d√©cembre 2011 : <strong>esprima</strong>.
<em>esprima</em> est un parseur ECMAScript √©crit en‚Ä¶ ECMAScript.
Donc capable de fonctionner aussi bien dans Node que dans un navigateur web.<br>
Si √ßa n&#8217;a l&#8217;air de rien, ce projet ouvre la voie √† un √©cosyst√®me entier de modules qui vont faire de Node la plateforme de pr√©dilection pour assembler ses projets <em>frontend</em> : minifieurs plus performants, <em>linters</em> dynamiques, mais aussi et surtout, l&#8217;av√®nement des <strong>transpilateurs</strong>.
Ces derniers compilent de l&#8217;ECMAScript (ou une surcouche d&#8217;ECMAScript) en ECMAScript interpr√©table par une VM ECMAScript classique.</p>
</div>
<div class="paragraph">
<p><em>Coffeescript</em> est un exemple populaire de surcouche ECMAScript.
Ce langage a fortement contribu√© √† transvaser nombre de ses fonctionnalit√©s vers la sp√©cification ECMAScript 6 : classes, fonctions fl√©ch√©es, cha√Ænes multi-lignes, destructuration etc.</p>
</div>
<div class="paragraph">
<p>On parle de <em>transpilation</em> et non de <em>compilation</em> car le processus de transformation traduit un langage en un autre langage qui n&#8217;est pas un langage machine.
On compile un certain langage en ECMAScript qui n√©cessite une VM ECMAScript pour que les instructions soient enfin traduites en op√©rations CPU.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Attention</span> Coffeescript ou pas Coffeescript ?</div>
<div class="paragraph">
<p>Il n&#8217;est pas recommand√© d&#8217;utiliser <em>Coffescript</em> sur de nouveaux projets depuis la sortie d&#8217;ECMAScript 2015.</p>
</div>
<div class="paragraph">
<p>Si vous souhaitez un langage davantage typ√© qu&#8217;ESCMAScript, je vous recommande de vous pencher sur <a href="#typescript">TypeScript</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>La transpilation offre plusieurs avantages face √† la cr√©ation d&#8217;un langage compil√© √† part enti√®re :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>le code transpil√© est un <strong>art√©fact durable</strong> ‚Äî souvent lisible et modifiable par un humain ‚Äî qui permet √©ventuellement de se passer du langage transpil√© initial ;</p>
</li>
<li>
<p>la <strong>compl√©mentarit√©</strong> avec l&#8217;√©cosyst√®me ECMAScript ‚Äî c&#8217;est quand m√™me plus sympa que de devoir tout r√©inventer ;</p>
</li>
<li>
<p>l&#8217;orientation vers des <strong>langages davantage maintenables</strong> b√©n√©ficiant √† terme √† la sp√©cification ECMAScript.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La suite de cette section s&#8217;int√©ressera √† des transpilateurs modernes et singuliers pour vous aider √† vous faire une id√©e de leur utilit√© au sein d&#8217;un projet web g√©r√© seul, en √©quipe ou en communaut√©.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Lien</span> Annonce d&#8217;esprima</div>
<div class="paragraph">
<p><em>Aryia Hidayat</em> introduit exprima dans un billet de blog.
Il y pr√©sente notamment des comparatifs de performances d&#8217;ex√©cution sur diff√©rentes VM ECMAScript et face √† d&#8217;autres parseurs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://ariya.io/2011/12/introducing-esprima" class="bare">ariya.io/2011/12/introducing-esprima</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_traceur">Traceur</h4>
<div class="paragraph">
<p><em>Traceur</em> est un des premiers transpilateurs ES6 vers ES5 √† avoir √©merg√© dans l&#8217;√©cosyst√®me Node.
Il est le fruit d&#8217;ing√©nieurs de <strong>Google</strong>.</p>
</div>
<div class="paragraph">
<p>L&#8217;avantage de <em>traceur</em> ?
Avoir permis d'<strong>√©crire des modules en ES6 avant que la sp√©cification ne soit enti√®rement termin√©e</strong>.
Et donc de pouvoir anticiper son apprentissage tout en mettant le langage √† l&#8217;√©preuve avant sa finalisation.</p>
</div>
<div class="paragraph">
<p>Il a depuis √©t√© d√©pass√© en terme d&#8217;int√©gration, de modularit√© et de compl√©tion d&#8217;impl√©mentation de fonctionnalit√©s ES6 par <a href="#babel">Babel</a> (voir ci-apr√®s).</p>
</div>
</div>
<div class="sect3">
<h4 id="babel">Babel</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="typescript">TypeScript</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="_publication_sur_npm">Publication sur npm</h4>
<div class="paragraph">
<p>R√©pondre aux questions :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>quels impacts si on publie uniquement les sources d&#8217;un module non-interpr√©table directement par Node</p>
</li>
<li>
<p>quel fichier d√©clarer dans le <code>main</code> ?</p>
</li>
<li>
<p>comment faire pour publier ? Et pour tester ?</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="universal-applications">browserify, pierre angulaire d&#8217;un code universel</h3>
<div class="paragraph">
<p>Le concept d'<strong>applications universelles</strong> (parfois appel√©es <em>applications isomorphiques</em>) a √©t√© sur toutes les bouches en 2015.</p>
</div>
<div class="paragraph">
<p>Imaginez une application o√π la logique de routage des requ√™tes HTTP (<em>routing</em>), l&#8217;acc√®s aux donn√©es et le rendu HTML s&#8217;ex√©cutent aussi bien dans un environnement Node que dans un navigateur web.
Imaginez un m√©canisme permettant de dissocier des comportements sp√©cifiques √† un environnement Node de ceux d&#8217;un navigateur web ‚Äî notamment la manipulation d&#8217;√©l√©ments DOM.</p>
</div>
<div class="paragraph">
<p>Beaucoup y voient un moyen d&#8217;enfin d√©velopper des applications web monopages (<em>single page apps</em>) rapides et accessibles ‚Äî souvenez-vous de l&#8217;√©poque des sites enti√®rement d√©velopp√©s en Flash qui √©taient invisibles aux yeux des moteurs de recherche.</p>
</div>
<div class="paragraph">
<p>On peut ainsi <strong>combiner</strong> l&#8217;approche web <em>classique</em> et des <em>interfaces dynamiques</em> sans pour autant imposer une page blanche en attendant que les centaines de kilo-octets (voire de m√©ga-octets) de la base de code ECMAScript de votre application soit transf√©r√©e sur le r√©seau puis interpr√©t√©e par le navigateur.<br>
C&#8217;est sans parler des performances r√©seau et de puissance de calcul plus r√©duites sur mobile.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Question</span> Ai-je besoin d&#8217;une application universelle ?</div>
<div class="paragraph">
<p>Il y a trois principales raisons <em>de tendre vers</em> la conception  d&#8217;applications universelles :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>vous √©ditez une application web monopage sans alternative accessible ou sans pr√©-rendu HTML ;</p>
</li>
<li>
<p>vous remarquez des doublons de code entre l&#8217;application web et son pendant c√¥t√© serveur ;</p>
</li>
<li>
<p>vous pensez qu&#8217;une partie de la logique c√¥t√© serveur pourrait √™tre r√©utilis√©e c√¥t√© web.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Le cas √©ch√©ant, on peut penser que vous n&#8217;avez qu&#8217;une faible fraction de votre m√©tier √† partager entre les deux environnements.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Je vais volontairement <em>tendre</em> vers la notion d&#8217;applications universelles sans pour autant l'<em>atteindre</em> enti√®rement.
Il s&#8217;agit d&#8217;un univers extr√™mement mouvant et les techniques deviennent rapidement obsol√®tes.</p>
</div>
<div class="paragraph">
<p>Enfin, je pr√©f√®re opter pour une approche hybride o√π l&#8217;on va progressivement partager une partie de nos composants entre Node et un navigateur web.
L&#8217;universalit√© implique encore une certaine complexit√© et je pr√©f√®re que l&#8217;on se concentre sur une approche incr√©mentale, respectueuse des comp√©tences et connaissances techniques √† disposition dans votre environnement de travail.</p>
</div>
<div class="paragraph">
<p>Nous parlerons d&#8217;abord de partage modulaire, de cha√Æne de construction, de remplacement de code √† la vol√©e avant de nous int√©resser √† un m√©canisme de rendu universel bas√© sur la librairie React.</p>
</div>
<div class="paragraph">
<p>Nous traiterons √©ventuellement des applications enti√®rement universelles dans une autre √©dition de ce m√™me ouvrage.
Entre temps, je vous encourage √† regarder ce qui se dit et ce qui se fait ailleurs.</p>
</div>
<div class="sect3">
<h4 id="_une_fonction_pour_node_et_un_navigateur_web">Une fonction pour Node et un navigateur web</h4>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Pr√©-requis</span> D√©marrage du serveur local</div>
<div class="paragraph">
<p>Les exemples suivant s&#8217;appuient sur un serveur embarqu√© pr√©sent dans le d√©p√¥t GitHub des exemples du chapitre 4.</p>
</div>
<div class="paragraph">
<p>Il sert statiquement le r√©pertoire d&#8217;exemples sur le port 4000 de la mani√®re suivante :</p>
</div>
<div class="listingblock">
<div class="title">chapter-04/examples</div>
<div class="content">
<pre>$ npm start</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Il est fr√©quent d&#8217;avoir √† effectuer des requ√™tes HTTP pour obtenir des donn√©es distantes.
L&#8217;impl√©mentation, les contraintes techniques et les mesures de s√©curit√© d&#8217;une telle requ√™te sont pourtant fonci√®rement diff√©rentes entre Node et un navigateur web.
Node fait appel aux modules <strong>http</strong> et <strong>https</strong> tandis que le navigateur dispose nativement de l&#8217;objet <strong>XMLHttpRequest</strong>, <strong>XMLHttpRequest level 2</strong> (depuis HTML5) ainsi que de <strong>fetch</strong> (depuis <em>ES2015</em>).</p>
</div>
<div class="paragraph">
<p>Nous n&#8217;avons pas encore attaqu√© l&#8217;impl√©mentation technique que la <em>simple requ√™te</em> para√Æt d√©j√† compliqu√©e en terme d'<em>universalit√©</em>.</p>
</div>
<div class="paragraph">
<p>Le module <em>superagent</em> √©merge en t√™te des r√©sultats si l&#8217;on recherche <em>browser</em> et <em>http</em> dans le registre <em>npm</em>.
Le module promet de fonctionner aussi bien avec Node qu&#8217;avec diff√©rents navigateurs web, Internet Explorer 8 inclus.
Prometteur non ?</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">npm</span> superagent</div>
<div class="paragraph">
<p>Le module <em>superagent</em> abstrait l&#8217;acc√®s au r√©seau via une API fluide et chainable.
Sa documentation en ligne d√©taille la gestion des verbes HTTP, l&#8217;envoi des donn√©es et la construction des param√®tres d&#8217;URL.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="URL"><a href="https://npmjs.com/superagent" class="bare">npmjs.com/superagent</a></span></p>
</li>
<li>
<p><span class="URL"><a href="https://visionmedia.github.io/superagent/" class="bare">visionmedia.github.io/superagent/</a></span></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Notre exemple se focalise sur l&#8217;interrogation d&#8217;une URL et l&#8217;affichage de sa r√©ponse dans la console :</p>
</div>
<div class="listingblock">
<div class="title">universal-http/index.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

if (typeof require === 'function') {      <i class="conum" data-value="1"></i><b>(1)</b>
  // eslint-disable-next-line global-require
  var superagent = require('superagent');
}

superagent
  .get('http://localhost:4000/src/universal-http/sample.json')
  .end((err, response) =&gt; {
    if (err) {
      throw err;
    }

    console.log(response.body.cheeses);   <i class="conum" data-value="2"></i><b>(2)</b>
  });</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>La fonction <code>require()</code> n&#8217;existe pas nativement dans le navigateur donc on ne charge le module <em>superagent</em> que dans Node ;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Affiche <code>[ 'Chaource', 'Stilton', 'Camembert' ]</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ce m√™me fichier <code>index.js</code> doit √™tre inclus dans une page HTML afin d&#8217;√™tre interpr√©t√© et ex√©cut√© par un navigateur web :</p>
</div>
<div class="listingblock">
<div class="title">universal-http/index.html</div>
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;script src="../../node_modules/superagent/superagent.js"&gt;&lt;/script&gt; <i class="conum" data-value="1"></i><b>(1)</b>
&lt;script src="index.js"&gt;&lt;/script&gt;                                    <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Puisque la fonction <code>require()</code> n&#8217;est pas disponible nativement dans les navigateurs, on se charge d&#8217;injecter <code>superagent</code> dans l&#8217;espace global ;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Affiche <code>[ 'Chaource', 'Stilton', 'Camembert' ]</code> lorsque le navigateur est dirig√© vers <code><a href="http://localhost:4000/src/universal-http/index.html" class="bare">localhost:4000/src/universal-http/index.html</a></code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Nous avons cr√©√© notre premier code universel, fonctionnant aussi bien dans un navigateur qu&#8217;avec Node !
Toutefois, on est tent√© d'<em>h√©siter entre magie et bricolage</em> ‚Ä¶ Est-on oblig√© de recourir √† des conditions ECMAScript pour √©viter d&#8217;ex√©cuter des APIs propres √† Node ? Et surtout, <strong>que se passe-t-il sous le capot de <em>superagent</em></strong> pour parvenir √† un tel r√©sultat ?</p>
</div>
<div class="paragraph">
<p>Il est grand temps de parler de <em>browserify</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="browserify">Utilisation de <em>browserify</em></h4>
<div class="paragraph">
<p>Le d√©veloppement de <strong>browserify</strong> a d√©but√© fin 2010 mais a vraiment pris son envol d√©but 2013 avec sa version 2.<br>
L&#8217;objectif de <em>browserify</em> est de permettre l&#8217;utilisation de l&#8217;API CommonJS (<code>require()</code> etc.) et de r√©√©crire des parties sp√©cifiques de code pour g√©n√©rer du code ECMAScript fonctionnel dans un environnement de navigateur web.</p>
</div>
<div class="paragraph">
<p><em>browserify</em> ne cherche pas √† √™tre intelligent sur les √©l√©ments √† remplacer mais offre une interface de transformation (les <em>transforms</em>) pour permettre √† tout un chacun de r√©√©crire selon ses besoins.<br>
Ces transformations s&#8217;appliquent √† deux niveaux :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>les <strong>fichiers</strong>, en les interchangeant lors des appels √† la fonction <code>require()</code> ;</p>
</li>
<li>
<p>l'<strong>arbre syntaxique</strong>, en d√©l√©gant aux <em>transforms</em> la r√©√©criture des d√©clarations et des √©l√©ments de syntaxe dont ils sont responsables.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Voici quelques exemples de <em>transforms</em> utiles et fr√©quemment rencontr√©s dans diff√©rents modules :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>brfs</em> : injecte le contenu de fichiers charg√©s via l&#8217;API <code>fs</code> ;</p>
</li>
<li>
<p><em>browserify-hmr</em> : remplace les modules √† vol√©e dans le navigateur lors d&#8217;un changement de code source ;</p>
</li>
<li>
<p><em>envify</em> : remplacement les appels √† <code>process.env</code> par leur valeur respective au moment de la transformation ;</p>
</li>
<li>
<p><em>babelify</em> : d√©l√®gue la transpilation de code ECMAScript et JSX √† <a href="#babel">Babel</a> ;</p>
</li>
<li>
<p><em>sassify</em> : transpile les inclusions de fichiers Sass en code CSS, optionnellement inject√© dans le navigateur au chargement du module en question ;</p>
</li>
<li>
<p><em>es3ify</em> : remplace certains √©l√©ments de langage en code ECMAScript 3, afin de supporter d&#8217;anciens navigateurs comme Internet Explorer 8.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Les <em>transforms</em> peuvent √™tre appliqu√©s de deux mani√®res :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>via l&#8217;option <code>--transform</code> en <strong>ligne de commande</strong> ;</p>
</li>
<li>
<p>via le champ <code>browserify.transform</code> du fichier <code>package.json</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>D√©butons avec l&#8217;utilisation des options en ligne de commande :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ browserify -e index.js -t brfs -t [ babelify --presets [es2015] ] -o dist/index.js</pre>
</div>
</div>
<div class="paragraph">
<p>Le <em>transform</em> <em>brfs</em> est employ√© tel quel tandis que <em>babelify</em>  fait appel √† des options de configurations suppl√©mentaires.</p>
</div>
<div class="paragraph">
<p>La configuration de ces m√™mes <em>transform</em> dans le fichier <code>package.json</code> ressemble √† ceci :</p>
</div>
<div class="listingblock">
<div class="title">package.json</div>
<div class="content">
<pre class="highlight"><code>{
  "name": "name": "nodebook.chapter-04",
  "...": "...,
  "browserify": {
    "transform": [
      "brfs",
      ["babelify", { "presets": ["es2015"] }]
    ]
  },
  "dependencies": {
    "babel-preset-es2015": "^6.3.0",
    "babelify": "^7.0.0",
    "brfs": "^1.4.0"
  },
  "devDependencies": {
    "browserify": "^12.0.0"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;utilisation de <em>browserify</em> en ligne de commande s&#8217;en retrouve simplifi√©e :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ browserify -e index.js -o dist/index.js</pre>
</div>
</div>
<div class="paragraph">
<p>Il y a deux choses importantes √† retenir √† propos du fonctionnement de <em>browserify</em> :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>browserify</em> suit tous les appels √† <code>require()</code> et s&#8217;applique donc en cascade aux modules descendants ;</p>
</li>
<li>
<p>les <em>transform</em> ne s&#8217;appliquent qu&#8217;au niveau du module dans lequel ils sont d√©clar√©s (sauf √† utiliser l&#8217;option <code>--global-transform</code> auquel cas ce <em>transform</em> sera appliqu√© √† tous les niveaux de l&#8217;arbre de d√©pendances).</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title"><span class="RemarquePreTitre">Astuce</span> Pourquoi utiliser le champ <code>browserify.transform</code> ?</div>
<div class="paragraph">
<p>L&#8217;utilisation du champ <code>browserify.transform</code> est tr√®s utile pour appliquer automatiquement des <em>transform</em> de mani√®re isol√©e et discr√®te sans polluer la cha√Æne de d√©pendances.</p>
</div>
<div class="paragraph">
<p>Vous pouvez ainsi combiner une arborescence de modules qui se basent sur des versions diff√©rentes d&#8217;ECMAScript, utilisent Sass et Less etc.</p>
</div>
<div class="paragraph">
<p>√Ä l&#8217;inverse, vous ne souhaiterez pas d√©clarer un <em>transform</em> si son usage est ponctuel, par exemple pour des besoins de d√©veloppement.</p>
</div>
<div class="paragraph">
<p>√Ä noter que les modules employ√©s par les <em>transform</em> du fichier <code>package.json</code> doivent √™tre d√©clar√©s en tant que <code>dependencies</code> afin qu&#8217;ils soient disponibles lors de leur inclusion par <em>browserify</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Il est √©galement possible de forcer l&#8217;application d&#8217;un <em>transform</em> sur l&#8217;int√©gralit√© de la cha√Æne de d√©pendances via l&#8217;option <code>--global-transform</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_une_fonction_universelle">Une fonction universelle</h4>
<div class="paragraph">
<p>L&#8217;exemple suivant illustre une r√©√©criture de notre pr√©c√©dent code de sorte √† le rendre agnostique √† son environnement d&#8217;ex√©cution :</p>
</div>
<div class="listingblock">
<div class="title">universal-http/index-browserify.js</div>
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';

const request = require('superagent');

request
  .get('http://localhost:4000/src/universal-http/sample.json')
  .end((err, response) =&gt; {
    if (err) {
      throw err;
    }

    console.log(response.body.cheeses);
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>browserify</em> inclut le code n√©cessaire √† l&#8217;ex√©cution de l&#8217;arbre de d√©pendances dessin√© par les multiples appels √† <code>require()</code> lors de l&#8217;op√©ration de transformation.<br>
La conversion de code peut s&#8217;effectuer depuis l&#8217;API Node de <em>browserify</em> mais aussi depuis un terminal :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ npm run browserify
# t√¢che pr√©sente dans `package.json` √©quivalente √†
$ browserify \
 --entrypoint src/universal-http/index-browserify \
 --output src/universal-http/bundle.js</pre>
</div>
</div>
<div class="paragraph">
<p>Le fichier HTML varie √† peine par rapport √† notre premi√®re tentative ‚Äî √† noter que nous n&#8217;incluons d√©sormais que le fichier g√©n√©r√© par <em>browserify</em> :</p>
</div>
<div class="listingblock">
<div class="title">universal-http/index-browserify.html</div>
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;script src="bundle.js"&gt;&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>On commence √† se rendre compte qu&#8217;il y a plusieurs notions d&#8217;universalit√© :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>du code ECMAScript interpr√©table √† la fois par Node et par un navigateur web ;</p>
</li>
<li>
<p>du code ECMAScript interpr√©table par Node et converti pour fonctionner dans un navigateur web.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>C&#8217;est sans compter sur du code interpr√©table par un navigateur web mais outill√© par Node.
Mais nous quittons l√† les terres de l&#8217;universalit√©.</p>
</div>
</div>
<div class="sect3">
<h4 id="_cibler_sp√©cifiquement_node_ou_le_navigateur">Cibler sp√©cifiquement Node ou le navigateur</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_templating_universel_avec_react">Templating universel avec React</h3>
<div class="sect3">
<h4 id="_pr√©sentation_de_react">Pr√©sentation de React</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rendu_avec_node">Rendu avec Node</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rendu_dans_le_navigateur">Rendu dans le navigateur</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exemple_d_int√©gration_avec_em_express_em">Exemple d&#8217;int√©gration avec <em>express</em></h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vers_des_applications_universelles">Vers des applications universelles ?</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_strat√©gies_de_gestion_des_ressources_frontend">Strat√©gies de gestion des ressources frontend</h3>
<div class="ulist">
<ul>
<li>
<p>build externe</p>
</li>
<li>
<p>inlining</p>
</li>
<li>
<p>extraction</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_tester_son_code">Tester son code</h3>
<div class="sect3">
<h4 id="_√âcrire_des_tests_avec_mocha_et_chai">√âcrire des tests avec mocha et chai</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ex√©cuter_les_suites_de_tests_avec_karma">Ex√©cuter les suites de tests avec Karma</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="_tester_la_compatibilit√©_navigateurs_avec_browserstack">Tester la compatibilit√© navigateurs avec BrowserStack</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
<div class="sect3">
<h4 id="_le_cas_internet_explorer_et_ievms">Le cas Internet Explorer et ievms</h4>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph">
<p>TBD.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-01-23 20:18:49 UTC
</div>
</div>
</body>
</html>